import{d as k,I as b,ae as E,r as B,b as c,m as I,p as S,e as C,cR as L,Z as D,c as h,q as f,a as r,v as F,cS as M,o as g,j as W}from"./index-c84c64f4.js";const A={class:"w-full h-full relative"},N={class:"loading"},T=W('<span class="loading-text-words">内</span><span class="loading-text-words">容</span><span class="loading-text-words">正</span><span class="loading-text-words">在</span><span class="loading-text-words">加</span><span class="loading-text-words">载</span><span class="loading-text-words">中</span>',7),U=[T],V=["src"],R=k({__name:"index",setup(j){const v=b(),l=E(),n=B(!1),i=c(()=>l.iframeUrl),o=I(),u=c(()=>o.theme==="dark");function _(){const e=document.getElementById("iframe");e!=null&&e.addEventListener||e==null||e.attachEvent("onload",d),e==null||e.addEventListener("load",d,!0)}const p=c(()=>o.theme);S(p,e=>{s({type:"theme",data:e})}),C(()=>{if(!i.value)return v.push("/");n.value=!0,_(),window.addEventListener("message",m)});async function m(e){const{type:t,data:a}=e.data;t==="theme"&&o.setTheme(a==="dark"?"dark":"light"),t==="chat"&&w(a)}function w(e){L({prompt:e}).then(t=>{const{code:a,data:y}=t;a===200&&s({type:"chat",data:x(y)})})}function x(e){const t=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;return e.replace(t,"")}function s(e){document.getElementById("iframe").contentWindow.postMessage(e,"*")}function d(){s({type:"theme",data:p.value});const e=M();e&&s({type:"token",data:e}),n.value=!1}return D(()=>{l.updateIframeUrl("");const e=document.getElementById("iframe");e==null||e.removeEventListener("load",d),window.removeEventListener("message",m)}),(e,t)=>(g(),h("div",A,[n.value?(g(),h("div",{key:0,class:f(["main-container absolute left-0 right-0 bottom-0 top-0 backdrop-blur",[u.value?"dark:bg-black/20":"bg-white/80"]])},[r("div",N,[r("div",{class:f(["loading-text ",u.value?"text-[#fff]":"text-[#000]"]),id:"loading-text"},U,2)])],2)):F("",!0),r("iframe",{id:"iframe",src:i.value,style:{width:"100%",height:"100%",border:"none"}},null,8,V)]))}});export{R as default};
